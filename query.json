{
  "scripts": {
    "dim_proddtaf0006_gold": "SELECT MCMCU, MCSTYL, MCDC, MCLDM, MCCO, MCCNTY, MCFMOD, MCDL01, MCDL02, MCRP01, MCRP02, MCTC01, MCTC02, MCTC03, MCTC04, MCTC05, MCTC06, MCTC07, MCCC01 FROM proddta_f0006",
    "dim_proddtaf0010_gold": "SELECT CCCO, CCNAME, CCDFYJ, CCPNC, CCDOT1, CCCRYR, CCCRYC, CCDOT2, CCDPRC, CCTXBM, CCNWXJ FROM proddta_f0010"
  },

  "G1scripts": {
    "DimOrderNumber": "SELECT trim(FSO.sales_document_number) AS OrderNumber, FSO.sales_document_item_number AS OrderLineNumber, FSO.Source_System AS SourceSystemKey, D.Year AS Year, D.YearMonth AS MonthKey, CONCAT(LEFT(D.MonthName, 3), ' ', D.Year) AS MonthFullShortName, FSO.Document_Date AS OrderDate, D.Datekey AS OrderDateKey FROM fact_sales_orders FSO LEFT JOIN dim_date D ON FSO.DOCUMENT_DATE = D.DATE INNER JOIN dim_division_texts DDT ON DDT.division = FSO.division AND DDT.Source_System = 'sap-slt' AND DDT.name = 'Neurovascular' WHERE FSO.Source_System = 'sap-s4' AND FSO.sales_document_type NOT IN ('1102', '1123')",
    "DimOrderType": "SELECT DISTINCT(FSO.sales_document_type) AS OrderTypeCode, FSO.sales_document_type_description AS OrderType, FSO.Source_System AS SourceSystemKey, GETDATE() AS SourceSystemModifiedDate, NULL AS RevenueType, NULL AS OrderLineType, FSO.sales_document_item_category AS OrderLineTypeCode FROM fact_sales_orders FSO INNER JOIN dim_division_texts DDT ON FSO.division = DDT.division AND DDT.Source_System = 'sap-slt' AND DDT.name = 'Neurovascular' WHERE FSO.Source_System = 'sap-s4'",
    "BSC_Historic_Cost": "select Plant, MaterialNum, Year, Currency, Standard_Cost from (select PLANT as Plant, MATERIAL_NUM as MaterialNum, YEAR as Year, CURRENCY as Currency, STANDARD_COST as Standard_Cost, current_timestamp() as created_on, ROW_NUMBER() OVER (Partition by PLANT, MATERIAL_NUM, YEAR, CURRENCY order by Standard_cost) Rownum from env_stage_BSC_Historic_Cost) a where Rownum=1",
    "CustomerSync": "select distinct SYKAccountNumber, BSCAccountNumber from dbo_CustomerSync",
    "InvoiceOptOut": "select OptOutInvoiceNumber, CustomerAccountNumber, EffectiveDateKey, EndDateKey from dbo_InvoiceOptOut where (OptOutInvoiceNumber, CustomerAccountNumber) in (select OptOutInvoiceNumber, CustomerAccountNumber from dbo_InvoiceOptOut group by OptOutInvoiceNumber, CustomerAccountNumber having count(*)=1)",
    "CountryCutover": "select CountryISOCode, CountryName, CountryCutoverDate, EffectiveDate, EndDate from env_ops_CountryCutover",
    "CustomerOptOut": "select OptOutAccountNumber, Name, EffectiveDateKey, EndDateKey from dbo_CustomerOptOut",
    "dim_order_reason": "SELECT DISTINCT FSO.order_reason AS OrderReasonCode, CASE WHEN FSO.return_Reason IS NULL THEN 'UNK' ELSE FSO.return_Reason END AS ReturnReasonCode, FSO.Source_System AS SourceSystemKey, NULL AS BSC_OrderReasonCode, 'Unknown' AS ReturnReason, NULL AS OrderReason FROM fact_sales_orders FSO Inner Join dim_division_texts DDT ON DDT.division = FSO.division and DDT.Source_System = 'sap-slt' and DDT.name = 'Neurovascular' WHERE FSO.Source_System='sap-s4' AND FSO.order_reason IS NOT NULL UNION SELECT 'UNK' AS OrderReasonCode, 'Unknown' ReturnReasonCode, 'sap-s4' AS SourceSystemKey, NULL AS BSC_OrderReasonCode, 'UNK' AS ReturnReason, 'Unknown' AS OrderReason",
    "DimInvoiceNumber": "SELECT IFNULL(cast( left (cc.`#ORDERID`, 10) as string), 0) AS InvoiceNumber, coalesce(FB.billing_document_item_number,CC.LineNumber, 0) AS InvoiceLineNumber, IFNULL(FB.source_system,'sap-s4') AS SourceSystemKey from callidus_credit cc Left JOIN fact_billing FB ON cast(FB.billing_document_number as bigint) = cast( left (CC.`#ORDERID`, 10) as bigint) INNER JOIN fact_sales_orders FSO ON FB.sales_document_number=FSO.sales_document_number AND FB.sales_document_item_number=FSO.sales_document_item_number AND FB.source_system=FSO.source_system LEFT JOIN dim_date D ON CAST(COALESCE(FB.billing_year, CONCAT(CC.Period, '01')) AS DATE) = D.DATE Inner Join dim_division_texts DDT ON DDT.division = FB.division and DDT.Source_System = 'sap-slt' and DDT.name = 'Neurovascular' WHERE FB.Source_System='sap-s4' AND FSO.sales_document_type NOT in ('1102', '1123') AND CC.Territory_Owner=1 AND CC.EventtypeId='Revenue' AND CC.Period in (SELECT InvoiceDate FROM t03_fact_sales_orders)"
  }
}
